<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Old Templates Archive</title>
    <style>
    :root {
        --background-color: #f0f2f5;
        --card-color: #ffffff;
        --text-color: #333333;
        --secondary-text-color: #666666;
        --border-color: #ccc;
        --header-bg-color: #ffffff;
        --button-primary-bg: #42b72a;
        --button-secondary-bg: #3498db;
    }

    body.dark-theme {
        --background-color: #121212;
        --card-color: #1e1e1e;
        --text-color: #e0e0e0;
        --secondary-text-color: #a0a0a0;
        --border-color: #444;
        --header-bg-color: #1e1e1e;
        --button-primary-bg: #27ae60;
        --button-secondary-bg: #2980b9;
    }

    body { 
        font-family: Arial, sans-serif; 
        margin: 0; 
        background-color: var(--background-color); 
        color: var(--text-color);
        transition: background-color 0.3s, color 0.3s;
    }
    .container { max-width: 1200px; margin: 20px auto; padding: 0 20px; }
    header { 
        background-color: var(--header-bg-color); 
        padding: 20px; 
        text-align: center; 
        box-shadow: 0 2px 4px rgba(0,0,0,.1); 
        position: relative; 
    }
    .header-controls { display: flex; justify-content: space-between; align-items: center; max-width: 1200px; margin: 0 auto; }
    .theme-btn { font-size: 1.5rem; background: none; border: none; cursor: pointer; color: var(--text-color); }
    .language-switcher button { padding: 5px 10px; margin-left: 5px; border: 1px solid var(--border-color); background-color: transparent; cursor: pointer; color: var(--text-color); }
    .language-switcher button.active { background-color: var(--button-secondary-bg); color: white; }
    
    .template-builder { background: var(--card-color); padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,.1); margin: 40px 0; }
    .form-group input, .form-group textarea { width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 5px; box-sizing: border-box; background-color: var(--background-color); color: var(--text-color); }
    .cta-button { background-color: var(--button-primary-bg); }
    .template-card { background: var(--card-color); }
    
    /* ... آپ کے باقی اسٹائلز ... */
    /* ... The rest of your styles ... */
    
</style>

</head>
<body>

    <main class="container">
        <div class="template-gallery">
            <h2>Old Templates</h2>
            <div class="gallery-grid"></div>
        </div>
    </main>
    <header>
        <div class="header-controls">
    <div class="language-switcher">
        <button data-lang="en">English</button>
        <button data-lang="ur">اردو</button>
        <button data-lang="ar">العربية</button>
    </div>
    <button id="theme-switcher" class="theme-btn">🌙</button>
</div>

    </header>

    <div id="image-modal" class="modal">
      <div class="modal-content">
        <span class="close-button">&times;</span>
        <img id="modal-image" src="" alt="Modal Image">
        <h3 id="modal-title"></h3>
        <p id="modal-text"></p>
      </div>
    </div>

    <script>
        // --- ضروری عناصر اور متغیرات ---
        const galleryGrid = document.querySelector('.gallery-grid');
        const modal = document.getElementById('image-modal');
        const modalImage = document.getElementById('modal-image');
        const modalTitle = document.getElementById('modal-title');
        const modalText = document.getElementById('modal-text');
        const closeButton = document.querySelector('.close-button');
        const API_URL = 'https://my-template-builder-1.onrender.com';

        let originalTemplates = []; // اصل ڈیٹا یہاں محفوظ ہوگا

        // --- فنکشن: پرانی ٹیمپلیٹس دکھانا ---
        async function fetchAndDisplayTemplates() {
            try {
                const response = await fetch(`${API_URL}/api/templates`);
                originalTemplates = await response.json();
                const oldTemplates = originalTemplates.slice(1); // پہلی ٹیمپلیٹ کو چھوڑ کر باقی سب
                
                galleryGrid.innerHTML = '';

                oldTemplates.forEach((template, index) => {
                    const card = document.createElement('div');
                    card.className = 'template-card';
                    card.dataset.id = template._id; // کارڈ کو ٹیمپلیٹ کی اصل ID دیں
                    
                    card.innerHTML = `
                        <img src="${template.imageUrl}" alt="${template.title}">
                        <div class="card-actions">
                            <a href="${template.imageUrl}" class="download-btn" download>Download</a>
                            <button class="delete-btn" data-id="${template._id}">Delete</button>
                        </div>`;
                    galleryGrid.appendChild(card);
                });
            } catch (error) {
                console.error('ٹیمپلیٹس لوڈ کرنے میں ناکامی:', error);
            }
        }

        // --- ایونٹ ہینڈلرز ---
        galleryGrid.addEventListener('click', async function(event) {
            const card = event.target.closest('.template-card');

            if (event.target.classList.contains('delete-btn')) {
                event.stopPropagation();
                const id = event.target.dataset.id;
                if (confirm('کیا آپ واقعی اس ٹیمپلیٹ کو ڈیلیٹ کرنا چاہتے ہیں؟')) {
                    try {
                        const response = await fetch(`${API_URL}/api/templates/${id}`, { method: 'DELETE' });
                        if (!response.ok) throw new Error('ڈیلیٹ کرنے میں ناکامی');
                        await fetchAndDisplayTemplates();
                    } catch (error) {
                        alert('ناکامی: ' + error.message);
                    }
                }
            } else if (card) {
                const id = card.dataset.id;
                const template = originalTemplates.find(t => t._id === id); // ID کی بنیاد پر ٹیمپلیٹ تلاش کریں
                
                if (template) {
                    modalImage.src = template.imageUrl;
                    modalTitle.textContent = template.title;
                    modalText.textContent = template.text || '';
                    modal.style.display = 'block';
                }
            }
        });
        
        // موڈل کو بند کرنا
        closeButton.addEventListener('click', function() {
            modal.style.display = 'none';
        });
        window.addEventListener('click', function(event) {
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        });

        // تھیم سوئچر کا کوڈ
const themeSwitcher = document.getElementById('theme-switcher');

// فنکشن: تھیم سیٹ کرنا
const setTheme = (theme) => {
    if (theme === 'dark') {
        document.body.classList.add('dark-theme');
        themeSwitcher.textContent = '☀️'; // سورج کا آئیکن
    } else {
        document.body.classList.remove('dark-theme');
        themeSwitcher.textContent = '🌙'; // چاند کا آئیکن
    }
    localStorage.setItem('theme', theme);
};

// بٹن پر کلک کا ایونٹ
themeSwitcher.addEventListener('click', () => {
    const currentTheme = localStorage.getItem('theme') || 'light';
    if (currentTheme === 'light') {
        setTheme('dark');
    } else {
        setTheme('light');
    }
});

// صفحہ لوڈ ہوتے ہی محفوظ شدہ تھیم کو لاگو کریں
document.addEventListener('DOMContentLoaded', () => {
    const savedTheme = localStorage.getItem('theme') || 'light';
    setTheme(savedTheme);
    // ... آپ کا باقی DOMContentLoaded کا کوڈ ...
});

    </script>

</body>
</html>
