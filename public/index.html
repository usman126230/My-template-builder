<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
        

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Template Builder</title>
    <style>
    <style>
    :root {
        --background-color: #f0f2f5;
        --card-color: #ffffff;
        --text-color: #333333;
        --secondary-text-color: #666666;
        --border-color: #ccc;
        --header-bg-color: #ffffff;
        --button-primary-bg: #42b72a;
        --button-secondary-bg: #3498db;
    }

    body.dark-theme {
        --background-color: #121212;
        --card-color: #1e1e1e;
        --text-color: #e0e0e0;
        --secondary-text-color: #a0a0a0;
        --border-color: #444;
        --header-bg-color: #1e1e1e;
        --button-primary-bg: #27ae60;
        --button-secondary-bg: #2980b9;
    }

    body { 
        font-family: Arial, sans-serif; 
        margin: 0; 
        background-color: var(--background-color); 
        color: var(--text-color);
        transition: background-color 0.3s, color 0.3s;
    }
    .container { max-width: 1200px; margin: 20px auto; padding: 0 20px; }
    header { 
        background-color: var(--header-bg-color); 
        padding: 20px; 
        text-align: center; 
        box-shadow: 0 2px 4px rgba(0,0,0,.1); 
        position: relative; 
    }
    .header-controls { display: flex; justify-content: space-between; align-items: center; max-width: 1200px; margin: 0 auto; }
    .theme-btn { font-size: 1.5rem; background: none; border: none; cursor: pointer; color: var(--text-color); }
    .language-switcher button { padding: 5px 10px; margin-left: 5px; border: 1px solid var(--border-color); background-color: transparent; cursor: pointer; color: var(--text-color); }
    .language-switcher button.active { background-color: var(--button-secondary-bg); color: white; }
    
    .template-builder { background: var(--card-color); padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,.1); margin: 40px 0; }
    .form-group input, .form-group textarea { width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 5px; box-sizing: border-box; background-color: var(--background-color); color: var(--text-color); }
    .cta-button { background-color: var(--button-primary-bg); }
    .template-card { background: var(--card-color); }
    
    /* ... ÿ¢Ÿæ ⁄©€í ÿ®ÿßŸÇ€å ÿßÿ≥Ÿπÿßÿ¶ŸÑÿ≤ ... */
    /* ... The rest of your styles ... */
    
</style>

    
</head>
<body>
    <div id="image-modal" class="modal">
  <div class="modal-content">
    <span class="close-button">&times;</span>
    <img id="modal-image" src="" alt="Modal Image">
    <h3 id="modal-title"></h3>
    <p id="modal-text"></p>
  </div>
</div>

    <header>
        <div class="header-controls">
    <div class="language-switcher">
        <button data-lang="en">English</button>
        <button data-lang="ur">ÿßÿ±ÿØŸà</button>
        <button data-lang="ar">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</button>
    </div>
    <button id="theme-switcher" class="theme-btn">üåô</button>
</div>

        <h1 data-translate-key="appTitle">AI Template Generator</h1>
    <a href="old_templates.html" target="_blank" class="view-old-btn">View Old Templates</a>
</header>

    <main class="container">
        <div class="template-builder">
            <h2 data-translate-key="createSectionTitle">Create with AI</h2>
            <form id="template-form">
                <div class="form-group">
                    <label for="template-title" data-translate-key="templateTitleLabel">Image Prompt</label>
                    <input type="text" id="template-title" name="title" required placeholder="e.g., A cute cat wearing a wizard hat">
                </div>
                <div class="form-group">
                    <label for="template-text" data-translate-key="detailedTextLabel">Detailed text</label>
                    <textarea id="template-text" name="text" rows="4"></textarea>
                </div>
                <button type="submit" class="cta-button" data-translate-key="createButton">Generate Template</button>
            </form>
            <div id="response-message" class="message"></div>
        </div>

        <div class="template-gallery">
            <h2 data-translate-key="currentTemplatesTitle">Generated Templates</h2>
            <div class="gallery-grid"></div>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 - AI Template Builder</p>
    </footer>

<script>
    // --- ÿ™ŸÖÿßŸÖ ÿ∂ÿ±Ÿàÿ±€å ÿπŸÜÿßÿµÿ± ÿßŸàÿ± ŸÖÿ™ÿ∫€åÿ±ÿßÿ™ ---
    const templateForm = document.getElementById('template-form');
    const titleInput = document.getElementById('template-title');
    const textInput = document.getElementById('template-text');
    const submitButton = templateForm.querySelector('.cta-button');
    const galleryGrid = document.querySelector('.gallery-grid');
    const modal = document.getElementById('image-modal');
    const modalImage = document.getElementById('modal-image');
    const modalTitle = document.getElementById('modal-title');
    const modalText = document.getElementById('modal-text');
    const closeButton = document.querySelector('.close-button');
    const API_URL = 'https://my-template-builder-1.onrender.com';

    let allTemplates = []; // ÿ™ŸÖÿßŸÖ Ÿπ€åŸÖŸæŸÑ€åŸπÿ≥ ⁄©Ÿà €å€Åÿß⁄∫ ŸÖÿ≠ŸÅŸàÿ∏ ⁄©ÿ±€å⁄∫ ⁄Ø€í

    // --- ÿß€ÅŸÖ ŸÅŸÜ⁄©ÿ¥ŸÜÿ≤ ---
    
    // ÿ™ŸÖÿßŸÖ Ÿπ€åŸÖŸæŸÑ€åŸπÿ≥ ⁄©Ÿà ŸÑÿßŸÜÿß ÿßŸàÿ± ÿØ⁄©⁄æÿßŸÜÿß
    // ŸÜ€åÿß ŸÅŸÜ⁄©ÿ¥ŸÜ: ÿµÿ±ŸÅ ÿ™ÿßÿ≤€Å ÿ™ÿ±€åŸÜ Ÿπ€åŸÖŸæŸÑ€åŸπ ÿØ⁄©⁄æÿßŸÜ€í ⁄©€í ŸÑ€å€í
async function fetchAndDisplayTemplates() {
    try {
        const response = await fetch(`${API_URL}/api/templates`);
        allTemplates = await response.json(); 
        galleryGrid.innerHTML = '';

        if (allTemplates.length > 0) {
            // ÿµÿ±ŸÅ Ÿæ€ÅŸÑ€å (ÿ≥ÿ® ÿ≥€í ŸÜÿ¶€å) Ÿπ€åŸÖŸæŸÑ€åŸπ ÿØ⁄©⁄æÿßÿ¶€å⁄∫
            const latestTemplate = allTemplates[0];
            const card = document.createElement('div');
            card.className = 'template-card';
            card.dataset.index = 0; 
            
            card.innerHTML = `
                <img src="${latestTemplate.imageUrl}" alt="${latestTemplate.title}">
                <div class="card-actions">
                    <a href="${latestTemplate.imageUrl}" class="download-btn" download>Download</a>
                    <button class="delete-btn" data-id="${latestTemplate._id}">Delete</button>
                </div>`;
            galleryGrid.appendChild(card);
        }

    } catch (error) {
        console.error('Ÿπ€åŸÖŸæŸÑ€åŸπÿ≥ ŸÑŸà⁄à ⁄©ÿ±ŸÜ€í ŸÖ€å⁄∫ ŸÜÿß⁄©ÿßŸÖ€å:', error);
    }
}


    // --- ÿß€åŸàŸÜŸπ €Å€åŸÜ⁄àŸÑÿ±ÿ≤ ---

    // AI ÿ≥€í Ÿπ€åŸÖŸæŸÑ€åŸπ ÿ®ŸÜÿßŸÜ€í ⁄©ÿß ŸÅÿßÿ±ŸÖ
    templateForm.addEventListener('submit', async function(event) {
        event.preventDefault();
        
        const originalButtonText = submitButton.textContent;
        submitButton.disabled = true;
        submitButton.textContent = 'Generating... Please wait...';

        const data = {
            title: titleInput.value,
            text: textInput.value
        };

        try {
            const response = await fetch(`${API_URL}/api/generate-template`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            const result = await response.json();
            if (!response.ok) throw new Error(result.message);
            
            alert('⁄©ÿßŸÖ€åÿßÿ®€å! ÿ¢Ÿæ ⁄©€å AI Ÿπ€åŸÖŸæŸÑ€åŸπ ÿ®ŸÜ ⁄Øÿ¶€å €Å€í€î');
            templateForm.reset();
            await fetchAndDisplayTemplates();
        } catch (error) {
            alert('ŸÜÿß⁄©ÿßŸÖ€å: ' + error.message);
        } finally {
            submitButton.disabled = false;
            submitButton.textContent = originalButtonText;
        }
    });

    // ⁄Ø€åŸÑÿ±€å ŸÖ€å⁄∫ ⁄©ŸÑ⁄©ÿ≥ ⁄©Ÿà ÿ≥ŸÜÿ®⁄æÿßŸÑŸÜÿß (ŸÖŸà⁄àŸÑ ÿßŸàÿ± ⁄à€åŸÑ€åŸπ)
    galleryGrid.addEventListener('click', async function(event) {
        const card = event.target.closest('.template-card');

        if (event.target.classList.contains('delete-btn')) {
            event.stopPropagation(); // ŸÖŸà⁄àŸÑ ⁄©Ÿà ⁄©⁄æŸÑŸÜ€í ÿ≥€í ÿ±Ÿà⁄©€å⁄∫
            const id = event.target.dataset.id;
            if (confirm('⁄©€åÿß ÿ¢Ÿæ ŸàÿßŸÇÿπ€å ÿßÿ≥ Ÿπ€åŸÖŸæŸÑ€åŸπ ⁄©Ÿà ⁄à€åŸÑ€åŸπ ⁄©ÿ±ŸÜÿß ⁄Üÿß€Åÿ™€í €Å€å⁄∫ÿü')) {
                try {
                    const response = await fetch(`${API_URL}/api/templates/${id}`, { method: 'DELETE' });
                    if (!response.ok) throw new Error('⁄à€åŸÑ€åŸπ ⁄©ÿ±ŸÜ€í ŸÖ€å⁄∫ ŸÜÿß⁄©ÿßŸÖ€å');
                    await fetchAndDisplayTemplates();
                } catch (error) {
                    alert('ŸÜÿß⁄©ÿßŸÖ€å: ' + error.message);
                }
            }
        } else if (card) { // ÿß⁄Øÿ± ⁄©ÿßÿ±⁄à Ÿæÿ± ⁄©ŸÑ⁄© €ÅŸàÿß €Å€í (ÿ®ŸπŸÜŸà⁄∫ ⁄©€í ÿπŸÑÿßŸà€Å)
            const index = card.dataset.index;
            const template = allTemplates[index];
            
            // ÿØÿ±ÿ≥ÿ™ ⁄©Ÿà⁄à: €å€Åÿß⁄∫ ÿ≥€í ÿ®⁄æ€å API_URL €ÅŸπÿß ÿØ€åÿß ⁄Ø€åÿß €Å€í
            modalImage.src = template.imageUrl;
            modalTitle.textContent = template.title;
            modalText.textContent = template.text || '';
            modal.style.display = 'block';
        }
    });
    
    // ŸÖŸà⁄àŸÑ ⁄©Ÿà ÿ®ŸÜÿØ ⁄©ÿ±ŸÜÿß
    closeButton.addEventListener('click', function() {
        modal.style.display = 'none';
    });
    window.addEventListener('click', function(event) {
        if (event.target == modal) {
            modal.style.display = 'none';
        }
    });

    // ÿ™⁄æ€åŸÖ ÿ≥Ÿàÿ¶⁄Üÿ± ⁄©ÿß ⁄©Ÿà⁄à
const themeSwitcher = document.getElementById('theme-switcher');

// ŸÅŸÜ⁄©ÿ¥ŸÜ: ÿ™⁄æ€åŸÖ ÿ≥€åŸπ ⁄©ÿ±ŸÜÿß
const setTheme = (theme) => {
    if (theme === 'dark') {
        document.body.classList.add('dark-theme');
        themeSwitcher.textContent = '‚òÄÔ∏è'; // ÿ≥Ÿàÿ±ÿ¨ ⁄©ÿß ÿ¢ÿ¶€å⁄©ŸÜ
    } else {
        document.body.classList.remove('dark-theme');
        themeSwitcher.textContent = 'üåô'; // ⁄ÜÿßŸÜÿØ ⁄©ÿß ÿ¢ÿ¶€å⁄©ŸÜ
    }
    localStorage.setItem('theme', theme);
};

// ÿ®ŸπŸÜ Ÿæÿ± ⁄©ŸÑ⁄© ⁄©ÿß ÿß€åŸàŸÜŸπ
themeSwitcher.addEventListener('click', () => {
    const currentTheme = localStorage.getItem('theme') || 'light';
    if (currentTheme === 'light') {
        setTheme('dark');
    } else {
        setTheme('light');
    }
});

// ÿµŸÅÿ≠€Å ŸÑŸà⁄à €ÅŸàÿ™€í €Å€å ŸÖÿ≠ŸÅŸàÿ∏ ÿ¥ÿØ€Å ÿ™⁄æ€åŸÖ ⁄©Ÿà ŸÑÿß⁄ØŸà ⁄©ÿ±€å⁄∫
document.addEventListener('DOMContentLoaded', () => {
    const savedTheme = localStorage.getItem('theme') || 'light';
    setTheme(savedTheme);
    // ... ÿ¢Ÿæ ⁄©ÿß ÿ®ÿßŸÇ€å DOMContentLoaded ⁄©ÿß ⁄©Ÿà⁄à ...
});

</script>

</body>
</html>
